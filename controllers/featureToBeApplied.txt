Feature: rooms object to store room-specific song and timestamp data.
Host Starts a Song

Feature: startSong
Store song ID, duration, and host's startTime and initialTimestamp.
Dynamic Host Timestamp Calculation

Feature: getHostTimestamp
Dynamically calculate the host’s current timestamp using startTime and initialTimestamp.
Broadcast Host's Timestamp

Feature: timestampBroadcast
Use setInterval to broadcast the host's current timestamp to all peers every second.
Peer Sync with Host

Feature: syncWithHost
Sync peers' playback by adjusting their timestamp based on the host’s broadcasted timestamp.
Peer Joining the Room

Feature: joinRoom
Send the current song, timestamp, and duration to new peers joining the room for synchronization.
Host Pauses Playback

Feature: pausePlayback
Save the current timestamp and stop updating startTime when the host pauses.
Host Resumes Playback

Feature: resumePlayback
Update startTime when the host resumes playback from the paused position.
Host Changes Song

Feature: changeSong
Update the current song, reset startTime, and notify peers to switch to the new song.
Additional Features:
Invite People to the Room

Feature: generateInviteLink
Generate a unique invite link for the room.
Feature: shareInviteLink
Allow users to share the invite link.

Feature: joinViaInvite
Handle joining the room via invite link.

Feature: notifyHost
Notify the host when someone joins via invite.

Check Registration Before Joining Room
Feature: checkRegistration
Verify if the user is registered before joining the room.

Feature: redirectToRegistration
Redirect unregistered users to a basic registration form.

Feature: basicRegistration
Create a registration form to collect username, name, and avatar.

Feature: saveUserData
Save the user’s registration info to the database.

Feature: grantRoomAccess
Allow access to the room after successful registration.

Feature: autoLoginReturningUsers
Skip registration for returning users and allow direct access to the room.

This combined approach will handle song synchronization, peer sync, invitation flow, and user registration smoothly.